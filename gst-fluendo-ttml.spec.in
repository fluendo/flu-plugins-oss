%{!?fc18: %define fc18 0}

%if %{fc18}
%define majorminor  1.0
%define gstreamer gstreamer1
%else
%define majorminor  0.10
%define gstreamer gstreamer
%endif

%{expand:%%define meego %(test -e /etc/meego-release && echo 1 || echo 0)}

Name:		%{gstreamer}-fluendo-ttml
Version:	@VERSION@
Release:	1.flu
Summary:	Fluendo GStreamer plug-in for TTML specification

Group:		Applications/Multimedia
License:	Commercial
URL:		http://www.fluendo.com/
Source:		gst-fluendo-ttml-%{version}.tar.bz2
BuildRoot:      %{_tmppath}/%{name}-%{version}-%{release}-root-%(%{__id_u} -n)

BuildRequires:  %{gstreamer}-devel 
%if ! %{meego}
BuildRequires:  %{gstreamer}-plugins-base-devel
%else
BuildRequires:  gst-plugins-base-devel
%endif

Requires:       pango >= 1.16.0 cairo pixman >= 0.18.0 libfludownloader
BuildRequires:  pango-devel >= 1.16.0 cairo-devel pixman-devel >= 0.18.0 libfludownloader_static
 
%description
Fluendo GStreamer plug-in for TTML specification

%prep
%setup -q -n gst-fluendo-ttml-%{version}

%build
%configure
make

%install
rm -rf $RPM_BUILD_ROOT
%makeinstall

# Remove unneeded .la and .a files
rm -rf $RPM_BUILD_ROOT/%{_libdir}/gstreamer-%{majorminor}/*.a
rm -rf $RPM_BUILD_ROOT/%{_libdir}/gstreamer-%{majorminor}/*.la

%clean
rm -rf $RPM_BUILD_ROOT

%files
%defattr(-,root,root, -)
%doc README COPYING AUTHORS NEWS 
%{_libdir}/gstreamer-%{majorminor}/libgstfluttml.so

%changelog
* Thu Jun 5 2014 Julien Moutte <julien@fluendo.com>
- Small tweaks for GStreamer 1.0

* Thu Sep 13 2012 Jorge Zapata <jzapata@fluendo.com>
- Initial spec file.
